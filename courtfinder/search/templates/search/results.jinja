{% extends "layout/base.jinja" %}
{% block page_title %}Find a court or tribunal{% endblock %}

{% block content %}
<div class="content inner cf">
  <header class="page-header">
    <h1>Find a court or tribunal</h1>
  </header>
</div>
<form method="get" action="results">
  <fieldset>
    {% if query %}
        <label for="postcode" class="form-block">
          <div class="form-label-bold">Search by name or address</div>
          <div class="form-hint">Enter part of the court or tribunal name or address.</div>
          <input class="form-control" type="text" name="q" />
        </label>
    {% else %}
        <label for="postcode" class="form-block">
          <div class="form-label-bold">Search results for postcode</div>
          <input type="text" name="postcode" value="{{ postcode }}"/>
        </label>
        <label for="area_of_law" class="form-block">
          <div class="form-label-bold">Filtered by courts or tribunals dealing with</div>
          <select name="area_of_law" id="area_of_law">
            <option value="All" {% if aol.name == "All" %}selected=selected{% endif %}>All courts and tribunals</option>
            {% for aol in areas_of_law %}
            <option value="{{aol.name}}" {% if aol.name == area_of_law %}selected=selected{% endif %}>{{ aol.name }}</option>
            {% endfor %}
          </select>
        </label>
      {% endif %}
      <div class="actions">
        <button id="again" class="button" type="submit">Search again</button>
      </div>
  </fieldset>
</form>

{% if search_results %}
  <p>{{ search_results|length }} results</p>
  <hr/>
  <ul>
    {% for court in search_results %}
    <li>
      <div><a href="https://courttribunalfinder.service.gov.uk/courts/{{ court.slug }}">{{ court.name }}</a></div>
      <div class="court-addresses">
        {% for address in court.addresses %}
          <h3>{{ address.type }} address</h3>
          <p>
          {% for line in address.address %}
            {% if line != "" %}
              {{ line }}<br/>
            {% endif %}
          {% endfor %}
          {{address.town}}<br/>
          {{address.postcode}}
          </p>
        {% endfor %}
      </div>
      <div class="court-aol">
        <p>This court or tribunal deals with the following legal problems:</p>
        <ul>
        {% for aol in court.areas_of_law %}
          <li><span {% if aol.name == area_of_law %}class="selected-aol"{% endif %}>{{ aol.name }}</span></li>
        {% endfor %}
        </ul>
      </div>
      <div class="court-map">
        <img src="http://maps.googleapis.com/maps/api/staticmap?size=290x235&zoom=15&markers={{court.lat}},{{court.lon}}" alt="location of the court on a map"/>
      </div>
      <hr class="clear"/>
    </li>
    {% endfor %}
  </ul>

  {% endif %}

{% endblock %}
